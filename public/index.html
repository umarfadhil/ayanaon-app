<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AyaNaon? by Petalytix</title>
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="favicon.svg">
    <link rel="manifest" href="manifest.webmanifest">
    <meta name="theme-color" content="#0c1222" media="(prefers-color-scheme: dark)">
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="map"></div>
    <button id="install-app-btn" type="button" hidden>Install App</button>
        <div id="action-menu" class="action-menu">
        <button id="action-menu-toggle" class="action-menu-toggle" type="button" aria-haspopup="true" aria-expanded="false" aria-controls="action-menu-content">Menu</button>
        <div id="action-menu-content" class="action-menu-content hidden">
            <section class="action-menu-section">
                <h3 class="action-menu-heading">Statistik</h3>
                <div id="metrics-container">
                    <div id="unique-ips-count"></div>
                    <div id="active-pins-count"></div>
                    <div id="live-sellers-count"></div>
                </div>
            </section>
            <section class="action-menu-section">
                <h3 class="action-menu-heading">Tampilan Peta</h3>
                <div class="action-menu-row map-type-row">
                    <button id="map-view-btn" class="map-type-btn active">Map</button>
                    <button id="satellite-view-btn" class="map-type-btn">Satellite</button>
                </div>
            </section>
            <section class="action-menu-section">
                <h3 class="action-menu-heading">Mode Perjalanan</h3>
                <div class="action-menu-row">
                    <div id="fuel-toggle-wrapper" class="fuel-toggle-wrapper">
                        <div id="fuel-toggle-container" data-mode="fuel" data-disabled="true">
                            <span class="toggle-label toggle-label-fuel">FUEL</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="fuel-toggle" aria-label="Toggle SPBU/SPBG or SPKLU">
                                <span class="toggle-slider"></span>
                            </label>
                            <span class="toggle-label toggle-label-ev">EV</span>
                        </div>
                    </div>
                    <button id="special-category-off-btn" type="button" class="menu-pill-btn" aria-label="Hide fuel and EV stations">🚶🏻</button>
                    <span class="action-menu-row-note">Tampilkan SPBU / EV terdekat atau pilih jalan kaki 🚶🏻 untuk menyembunyikan</span>
                </div>
            </section>
            <section id="menu-gerobak-section" class="action-menu-section">
                <h3 class="action-menu-heading">Gerobak Online</h3>
                <div id="live-seller-panel" class="live-seller-panel hidden">
                    <div class="live-seller-panel-header">
                        <div class="live-seller-panel-title">
                            <span id="live-seller-status-text" class="live-seller-status offline">Offline</span>
                        </div>
                        <div class="live-seller-panel-actions">
                            <button id="live-seller-login-btn" type="button" class="live-seller-secondary-btn">Login</button>
                            <button id="live-seller-logout-btn" type="button" class="live-seller-secondary-btn" hidden>Logout</button>
                        </div>
                    </div>
                    <div id="live-seller-profile" class="live-seller-profile hidden">
                        <img id="live-seller-photo" class="live-seller-photo hidden" alt="Foto lapak penjual">
                        <div class="live-seller-profile-text">
                            <div id="live-seller-name" class="live-seller-name"></div>
                            <div id="live-seller-brand" class="live-seller-brand hidden"></div>
                            <div id="live-seller-community-badge" class="live-seller-community-badge hidden">Verified by Warga</div>
                            <a id="live-seller-phone" class="live-seller-phone hidden" href="#"></a>
                            <div id="live-seller-phone-note" class="live-seller-phone-note hidden"></div>
                        </div>
                    </div>
                    <button id="live-seller-toggle-btn" type="button" class="live-seller-primary-btn" disabled>Mulai</button>
                    <div class="live-seller-links live-seller-links-authenticated">
                        <button id="live-seller-edit-profile-btn" type="button" class="menu-pill-btn live-seller-menu-link">Edit Profil Gerobak</button>
                        <a href="verify.html" class="menu-pill-btn live-seller-menu-link">Panduan Badge Warga</a>
                    </div>
                </div>
                <div id="live-seller-auth-links" class="live-seller-links live-seller-auth-links">
                    <a id="live-seller-auth-primary" href="login.html" class="menu-pill-btn live-seller-menu-link">Masuk</a>
                    <a id="live-seller-auth-secondary" href="register.html" class="menu-pill-btn live-seller-menu-link">Daftar</a>
                </div>
            </section>
            <section id="menu-resident-section" class="action-menu-section">
                <h3 class="action-menu-heading">Warga Terdaftar</h3>
                <div id="resident-authenticated" class="resident-authenticated hidden">
                    <div class="resident-greeting">Halo, <span id="resident-name"></span>!</div>
                    <div class="resident-kindness">
                        Badge kebaikan kamu: <span id="resident-badge-count">0</span>
                    </div>
                    <div id="resident-share-controls" class="resident-share-controls">
                        <button id="resident-share-toggle-btn" type="button" class="menu-pill-btn resident-menu-link resident-share-btn">Matikan Berbagi Lokasi</button>
                        <div id="resident-share-status" class="resident-share-status">Lokasi kamu sedang dibagikan ke Gerobak Online.</div>
                    </div>
                    <button id="resident-logout-btn" type="button" class="live-seller-secondary-btn resident-logout-btn">Logout</button>
                </div>
                <div id="resident-auth-links" class="resident-auth-links">
                    <a id="resident-login-link" href="warga-login.html" class="menu-pill-btn resident-menu-link">Masuk</a>
                    <a id="resident-register-link" href="warga-register.html" class="menu-pill-btn resident-menu-link">Daftar</a>
                </div>
                <p id="resident-prompt" class="resident-prompt">Bagikan badge ke penjual favoritmu dan lihat seberapa dermawan kamu.</p>
            </section>
        </div>
    </div>
    <button id="add-pin-btn" title="Add Pin" aria-label="Add Pin">+</button>
    <button id="info-btn" title="Info" aria-label="Info">ⓘ</button>
    <button id="filter-btn" title="Filter" aria-label="Filter">🔍︎</button>
    <button id="reset-filter-btn" title="Reset Filter" aria-label="Reset Filter">♻</button>
    <button id="locate-me-btn" title="Locate Me" aria-label="Locate Me">➤</button>
    <div id="filter-dropdown" class="hidden">
        <div id="filter-container">
            <div class="filter-search">
                <input type="text" id="filter-search-input" placeholder="Bakso, Marathon 5K, Konser Noah, dll." aria-label="Cari pin">
            </div>
            <div class="filter-date-range" aria-label="Filter tanggal">
                <input type="text" id="filter-date-range-input" placeholder="Pilih tanggal atau rentang" aria-label="Filter tanggal" readonly>
                <button id="filter-search-btn" type="button">Cari</button>
            </div>
            <label><input type="checkbox" id="select-all-categories" checked> Select All</label><br>
            <label><input type="checkbox" class="category-checkbox" value="🏡 Akomodasi Pilihan" checked> 🏡 Akomodasi Pilihan</label><br>
            <label><input type="checkbox" class="category-checkbox" value="🐾 Barang & Hewan Hilang" checked> 🐾 Barang & Hewan Hilang</label><br>
            <label><input type="checkbox" class="category-checkbox" value="🎭 Budaya & Hiburan" checked> 🎭 Budaya & Hiburan</label><br>
            <label><input type="checkbox" class="category-checkbox" value="🎓 Edukasi" checked> 🎓 Edukasi</label><br>
            <label><input type="checkbox" class="category-checkbox" value="🤝 Jual-Beli Barang" checked> 🤝 Jual-Beli Barang</label><br>
            <label><input type="checkbox" class="category-checkbox" value="🎉 Konser Musik & Acara" checked> 🎉 Konser Musik & Acara</label><br>
            <label><input type="checkbox" class="category-checkbox" value="🏃🏻 Olahraga & Aktivitas Hobi" checked> 🏃🏻 Olahraga & Aktivitas Hobi</label><br>
            <label><input type="checkbox" class="category-checkbox" value="🛍️ Pasar Lokal & Pameran" checked> 🛍️ Pasar Lokal & Pameran</label><br>
            <label><input type="checkbox" class="category-checkbox" value="🍔 Promo & Diskon Makanan / Minuman" checked> 🍔 Promo & Diskon Makanan/Minuman</label><br>
            <label><input type="checkbox" class="category-checkbox" value="💸 Promo & Diskon Lainnya" checked> 💸 Promo & Diskon Lainnya</label><br>
            <label><input type="checkbox" class="category-checkbox" value="🏆 Restoran Legendaris" checked> 🏆 Restoran Legendaris</label><br>            
            <label><input type="checkbox" class="category-checkbox" value="🧑‍🤝‍🧑 Sosial & Kopdar" checked> 🧑‍🤝‍🧑 Sosial & Kopdar</label><br>            
            <label><input type="checkbox" class="category-checkbox" value="⛽ SPBU/SPBG" checked> ⛽ SPBU/SPBG</label><br>
            <label><input type="checkbox" class="category-checkbox" value="⚡ SPKLU" checked> ⚡ SPKLU</label><br>
            <label><input type="checkbox" class="category-checkbox" value="💡 Lain-lain" checked> 💡 Lain-lain</label><br>
        </div>
    </div>
    <div id="pin-form" class="hidden">
        <h2>Aya Naon?</h2>
        <form id="add-pin-form">
            <input type="text" id="title" placeholder="Judul" required>
            <textarea id="description" placeholder="Deskripsi" required></textarea>
            <select id="category" required>
                <option value="" disabled selected>Pilih Kategori</option>
                <option value="🎭 Budaya & Hiburan">🎭 Budaya & Hiburan</option>
                <option value="🐾 Barang & Hewan Hilang">🐾 Barang & Hewan Hilang</option>
                <option value="🎓 Edukasi">🎓 Edukasi</option>
                <option value="🤝 Jual-Beli Barang">🤝 Jual-Beli Barang</option>
                <option value="🎉 Konser Musik & Acara">🎉 Konser Musik & Acara</option>
                <option value="🏃🏻 Olahraga & Aktivitas Hobi">🏃🏻 Olahraga & Aktivitas Hobi</option>
                <option value="🛍️ Pasar Lokal & Pameran">🛍️ Pasar Lokal & Pameran</option>
                <option value="🍔 Promo & Diskon Makanan / Minuman">🍔 Promo & Diskon Makanan / Minuman</option>
                <option value="💸 Promo & Diskon Lainnya">💸 Promo & Diskon Lainnya</option>                
                <option value="🧑‍🤝‍🧑 Sosial & Kopdar">🧑‍🤝‍🧑 Sosial & Kopdar</option>                
                <option value="💡 Lain-lain">💡 Lain-lain</option>
            </select>
            <select id="lifetime-select" required>
                <option value="" disabled selected>Pilih Waktu</option>
                <option value="today">Hari Ini</option>
                <option value="date">Pilih Tanggal</option>
            </select>
            <input type="date" id="lifetime-date-picker" placeholder="Pilih Tanggal">
            <input type="text" id="link" placeholder="Link">
            <button type="submit">Bagikan</button>
        </form>
    </div>
    <div id="live-seller-edit-modal" class="modal-overlay hidden">
        <div class="modal-content live-seller-edit-modal">
            <button id="live-seller-edit-close" type="button" class="close-btn" aria-label="Tutup">&times;</button>
            <h2>Edit Profil Gerobak Online</h2>
            <form id="live-seller-edit-form" class="live-seller-edit-form">
                <div id="live-seller-edit-message" class="live-seller-edit-message"></div>
                <div class="live-seller-edit-field">
                    <label for="live-seller-edit-name">Nama Gerobak</label>
                    <input type="text" id="live-seller-edit-name" name="nama" autocomplete="organization" required maxlength="80">
                </div>
                <div class="live-seller-edit-field">
                    <label for="live-seller-edit-brand">Brand / Menu Utama</label>
                    <input type="text" id="live-seller-edit-brand" name="merk" autocomplete="organization-title" required maxlength="80">
                </div>
                <div class="live-seller-edit-field">
                    <label for="live-seller-edit-description">Deskripsi</label>
                    <textarea id="live-seller-edit-description" name="deskripsi" rows="4" required maxlength="500" placeholder="Ceritakan menu favorit, promo, atau lokasi mangkal kamu."></textarea>
                </div>
                <div class="live-seller-edit-field">
                    <label for="live-seller-edit-phone">Nomor WhatsApp</label>
                    <input type="tel" id="live-seller-edit-phone" name="phoneNumber" autocomplete="tel" required placeholder="+6281234567890">
                </div>
                <div class="live-seller-edit-field live-seller-edit-field--toggle">
                    <label class="live-seller-edit-toggle">
                        <input type="checkbox" id="live-seller-edit-show-phone">
                        <span>Tampilkan nomor WhatsApp ke warga</span>
                    </label>
                    <p class="live-seller-edit-toggle-hint">Saat dimatikan, warga tidak dapat melihat nomor atau tombol WhatsApp kamu.</p>
                </div>
                <div class="live-seller-edit-field">
                    <label for="live-seller-edit-photo">Foto Gerobak</label>
                    <div class="live-seller-edit-photo-field">
                        <div class="live-seller-edit-photo-preview" id="live-seller-edit-photo-preview-container">
                            <img id="live-seller-edit-photo-preview" alt="Preview foto Gerobak" />
                            <div id="live-seller-edit-photo-placeholder">Belum ada foto</div>
                        </div>
                        <div class="live-seller-edit-photo-controls">
                            <input type="file" id="live-seller-edit-photo" accept="image/*">
                            <button type="button" id="live-seller-edit-photo-reset" class="live-seller-secondary-btn">Gunakan Foto Saat Ini</button>
                        </div>
                        <p class="live-seller-edit-photo-hint">Format JPG atau PNG, ukuran maksimal 1MB.</p>
                    </div>
                </div>
                <div class="live-seller-edit-field">
                    <label for="live-seller-edit-menu-photos">Foto Menu</label>
                    <div id="live-seller-edit-menu-preview" class="live-seller-edit-menu-grid" aria-live="polite"></div>
                    <div class="live-seller-edit-menu-controls">
                        <input type="file" id="live-seller-edit-menu-photos" accept="image/*" multiple>
                        <button type="button" id="live-seller-edit-menu-clear" class="live-seller-secondary-btn">Hapus Semua Foto Menu</button>
                    </div>
                    <p class="live-seller-edit-photo-hint">Unggah hingga 3 foto menu, maksimal 4MB per foto.</p>
                </div>
                <button type="submit" id="live-seller-edit-submit" class="live-seller-primary-btn">Simpan Perubahan</button>
            </form>
        </div>
    </div>
    <div id="welcome-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button id="close-modal-btn" class="close-btn">&times;</button>
            <h2>Selamat Datang di <b>AyaNaon?</b></h2>
            <p>Ini adalah peta berbasis komunitas untuk berbagi informasi, promosi, hingga laporan untuk membantu sesama warga di sekitar kita.</p>
            <p><strong>Navigasi:</strong></p>
                <p>✚ : Menambah Pin</p>
                <p>🔍︎ : Filter</p>
                <p>♻ : Reset Filter</p>
                <p>➤ : Lokasi Saat Ini</p>
                <p>ⓘ : Informasi</p>
                <p>_</p>

            <p><strong>Mulai Berbagi:</strong></p>
                Zoom lokasi yang ingin kamu pin ➜ Tekan hingga muncul pin merah 📍 ➜ Klik tanda <b>➕</b> ➜ Lengkapi informasi ➜ Bagikan
            <p><strong>Aturan Umum:</strong></p>
            <ul>
                <li>Layanan ini bersifat terbuka dan gratis tanpa biaya.</li>
                <li>Nama maupun identitas reporter/warga bersifat anonim.</li>
                <li>Silahkan berbagi informasi yang positif dan bermanfaat untuk para Warga.</li>
                <li>Jangan bagikan aktivitas ilegal, spam, atau palsu.</li>
                <li>Pin yang sudah dibagikan tidak dapat dihapus.</li>
                <li>Pin hanya dapat di-edit oleh Reporter yang membuat.</li>
                <li>Pin akan otomatis terhapus setelah tanggal yang ditentukan.</li>
                <li>Berikan 👍 jika suka dan 👎 jika tidak.</li>
                <li>Gunakan fitur filter untuk mencari hal yang Warga minati.</li>

            </ul>
            <p> </p>
            <p><b>Terima kasih dan selamat berselancar, Warga 🏄‍♀️🌊</b></p>
            <p><i>Silahkan email <a href="mailto:contact@petalytix.id">contact@petalytix.id</a> jika ingin kontak dengan developer</i></p>
            <div style="font-size: 10px;;">Powered by Petalytix │ Ver. 2.0.0</div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr" defer></script>
    <script src="https://unpkg.com/@googlemaps/markerclusterer/dist/index.min.js" defer></script>
    <script src="resident-session.js"></script>
    <script src="auth.js"></script>
    <script src="app.js"></script>
</body>
</html>
